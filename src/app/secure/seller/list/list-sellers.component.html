<mat-drawer-container class="drawer-container" [hasBackdrop]="true">
  <mat-drawer #drawer [mode]="'over'" [position]="'end'" class="example-sidenav">
    <!-- Formulario para realizar filtro de listado de vendedores -->
    <form class="basic-info" #createfilterSeller="ngForm" [formGroup]="filterSeller" class="seller-filter-sidenav">
      <div fxLayout="row" fxLayoutAlign="space-between center">
        <h3>Filtro vendedores</h3>
        <button id="closeMenuApplication" type="button" color="primary" matTooltip="Cerrar" matTooltipPosition="below"
          mat-icon-button mat-button (click)="drawer.toggle()">
          <mat-icon>clear</mat-icon>
        </button>
      </div>

      <div fxLayout="column" fxLayoutAlign="space-between" fxLayoutAlign.xs="center center" fxLayout.xs="column">
        <mat-form-field color="primary">
          <input matInput placeholder="ID" formControlName="id" [errorStateMatcher]="matcher" (matChipInputTokenEnd)="add($event)"
            [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" >
          <mat-hint></mat-hint>
          <mat-error *ngIf="filterSeller.get('id').hasError('pattern')" [innerHTML]="'ID invalido'"></mat-error>
        </mat-form-field>
        <mat-form-field>
          <input matInput placeholder="Nombre del vendedor" formControlName="sellerName" [errorStateMatcher]="matcher"
            (matChipInputTokenEnd)="add($event)" [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            >
            <mat-error *ngIf="filterSeller.get('sellerName').hasError('trim')">Nombre invalido</mat-error>
          <!-- <mat-hint></mat-hint>
  <mat-error *ngIf="filterForm.get('ean').hasError('pattern')" [innerHTML]="'EAN invalido'"></mat-error> -->
        </mat-form-field>
        <mat-form-field>
          <input matInput placeholder="NIT" formControlName="nit" [errorStateMatcher]="matcher" (matChipInputTokenEnd)="add($event)"
            [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" >
          <mat-hint></mat-hint>
          <mat-error *ngIf="filterSeller.get('nit').hasError('pattern')" [innerHTML]="'NIT invalido'"></mat-error>
        </mat-form-field>
        <div fxLayout="row" fxLayoutAlign="space-between center">
          <button mat-stroked-button color="primary" [innerHTML]="'Limpiar'" (click)="cleanFilter()"></button>
          <!-- <button mat-flat-button color="primary" type="submit" [innerHTML]="'Filtrar'" [disabled]="!filterSeller.form.valid || (!product.value && !ean.value && !stock.value)"></button> -->
          <button mat-flat-button color="primary" type="submit" [innerHTML]="'Filtrar'" (click)="drawer.toggle() && filterListSeller()"></button>
        </div>

      </div>
    </form>
  </mat-drawer>
  <mat-drawer-content>

    <div class="height-full" fxLayout="column">
      <mat-toolbar class="seller-list-toolbar">
        <div class="normal-theme toolbar-options-table" fxLayout="row" fxLayoutAlign="space-between center">
          <!--  Titulo del toolbar -->
          <p class="seller-list-title" fxShow [fxShow.xs]="false">
            Vendedores
            <small class="sub-title">| Listado de vendedores</small>
          </p>
          <!--  Titulo del toolbar -->
          <p class="seller-list-title" fxShow="false" [fxShow.xs]="true">
            Listado de vendedores
          </p>
          <!-- <mat-paginator [length]="sellerLength" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="pageEvent = $event">
          </mat-paginator> -->
        </div>
        <button type="button" mat-button (click)="drawer.toggle()">
          <mat-icon>filter_list</mat-icon>
          <small class="sub-title-filter" [innerHTML]="'Filtrar'"></small>
        </button>
      </mat-toolbar>
      <!-- Resultado Filtro -->
      <div class="example-chip-list">
        <mat-chip-list #chipList>
          <mat-chip *ngFor="let listFilterSeller of listFilterSellers" [selectable]="selectable" [removable]="removable" (removed)="remove(listFilterSeller)">
            {{listFilterSeller.name}}
            <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
          </mat-chip>
          <input [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
             disabled>
        </mat-chip-list>
      </div>

      <!-- SELLER CONTAINER LIST-->
      <div class="list-container" *ngIf="getFunctionality(read)">
        <!-- SELLER HEADER LIST-->
        <div id="header-list" class="header-list" fxLayout="row" fxLayoutAlign="space-around center"  fxHide.xs>
          <div id="id" class="label-container id">
            <label class="label-list">
              ID
            </label>
          </div>
          <div id="nit" class="label-container nit">
              <label class="label-list">
                Nit
              </label>
            </div>
          <div id="name" class="label-container name">
            <label class="label-list">
              Nombre del vendedor
            </label>
          </div>
          <div id="status" class="label-container status">
            <label class="label-list">
              Estado
            </label>
          </div>
          <div id="vacations" class="label-container vacations">
            <label class="label-list">
              Vacaciones
            </label>
          </div>
        </div>

        <!-- SELLER BODY LIST-->
        <div *ngFor="let seller of sellerList; let i = index " [ngClass]="{'background-bar' : seller.block}">
          <mat-progress-bar mode="indeterminate" *ngIf="seller.block"></mat-progress-bar>
          <!-- SELLER HEADER LIST-->
          <div id="body-list" class="header-list">
                <div id="id" class="label-container id">
                    <button mat-icon-button matTooltip="Administrar vendedor" (click)="redirectToSeller(seller.IdSeller)"
                      fxShow [fxShow.xs]="false" *ngIf="canVisualize">
                      <mat-icon class="material-icons">
                        visibility
                      </mat-icon>
                    </button>
                    <p class="title-list" >
                      ID
                    </p>
                    <label class="label-result">
                      {{seller.IdSeller}}
                    </label>
                  </div>
                  <div id="nit" class="label-container nit">
                      <p class="title-list">
                        Nit
                      </p>
                    <label class="label-result">
                      {{seller.Nit}}
                    </label>
                  </div>
                  <div id="name" class="label-container name">
                      <p class="title-list">
                        Nombre
                      </p>
                    <label class="label-result">
                      {{seller.Name}}
                    </label>
                  </div>
                <div id="status" class="label-container status">
                    <button mat-mini-fab 
                    id ="btn-enabled-seller"
                    (click) = "changeSellerStatus(seller, 'enabled', i)"
                    [ngClass]="seller.Status == 'Enable' ? 'enabledSellerButton' : 'grayBackgroundButton' " 
                    [disabled]="!seller.Status || seller.Status == 'Enable'">
                      <mat-icon aria-label="active status of seller">
                        check
                      </mat-icon>
                    </button>
                    <button mat-mini-fab
                    id="btn-disabled-seller"
                    (click) = "changeSellerStatus(seller, 'disabled', i)"
                    [ngClass]="seller.Status == 'Disable' ? 'warnColor' : 'grayBackgroundButton' " 
                    [disabled]="!seller.Status || seller.Status == 'Disable'">
                      <mat-icon aria-label="inactive status of seller">
                        block
                      </mat-icon>
                    </button>
                    <button mat-mini-fab
                    id="btn-vacation-seller" 
                    (click) = "changeSellerStatus(seller, 'vacation', i)"
                    [ngClass]="seller.Status == 'Vacations' ? 'primaryColor' : 'grayBackgroundButton' " 
                    [disabled]=" !seller.Status || seller.Status == 'Vacations' || seller.Status == 'Disable'">
                      <mat-icon aria-label="vacation status of seller">
                        local_airport
                      </mat-icon>
                    </button>
                  </div>
                  <div id="vacations" class="label-container vacations">
                    <p class="title-list">
                      Vacacaiones
                    </p>
                    <label class="label-result flex-end-center" *ngIf="!!seller.StartVacations && !!seller.EndVacations; else ProgramDate">
                         <div>
                            <strong>Inicio:</strong>{{seller.StartVacations}}<br/>
                            <strong>Fin:</strong>{{seller.EndVacations}}
                         </div>
                          <mat-icon (click)="sendToOpenCancelVacationDialog(i)">
                            cancel
                          </mat-icon>
                    </label>
                    <ng-template #ProgramDate>
                        <label class="label-result">
                            Programar Vacaciones
                      </label>                     
                    </ng-template>
                  </div>
          </div>
        </div>
      </div>
    </div>
  </mat-drawer-content>
</mat-drawer-container>


<ng-template #dialogContent *ngIf="needFormStates$ | async as status">
  <ng-container *ngIf="status.status == 'vacation'">
      <br/>
    <form [formGroup]="statusForm" class="full-width space-between margin-top__15">
      <mat-form-field class="half-width">
        <input matInput id="inputInitialDate" [matDatepicker]="intialPicker" [min]="tomorrow" [readonly]="true" placeholder="Fecha inicio" formControlName="StartDateVacation" (click)="openPicker(1)">
        <mat-datepicker-toggle matSuffix [for]="intialPicker"></mat-datepicker-toggle>
        <mat-datepicker #intialPicker disabled="false"></mat-datepicker>
      </mat-form-field>

      <mat-form-field class="half-width">
        <input matInput id="inputEndDate" [matDatepicker]="endPicker" [readonly]="true" [min]="startDateVacation.value" placeholder="Fecha final" formControlName="EndDateVacation" (click)="openPicker(2)">
        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
        <mat-datepicker #endPicker disabled="false"></mat-datepicker>
      </mat-form-field>

  </form>
  </ng-container>  
  <ng-container *ngIf="status.status == 'disabled'">
    <form [formGroup]="statusForm" class="margin-top__15">
        <mat-form-field class="full-width">
          <input matInput id="inputReason" placeholder="Motivo" autocomplete="false" formControlName="Reasons">
          <mat-error *ngIf="reason.hasError('maxlength')">El nombre no debe superar los 120 caracteres.</mat-error>
          <mat-error *ngIf="reason.hasError('required') || reason.hasError('trim')">Este campo es obligatorio.</mat-error>  
        </mat-form-field>
        <mat-form-field class="full-width">
          <textarea matInput id="inputObservation" placeholder="Observación" autocomplete="false" formControlName="Observations"></textarea>
          <mat-error *ngIf="observation.hasError('maxlength')">El nombre no debe superar los 2000 caracteres.</mat-error>
          <mat-error *ngIf="observation.hasError('required') || observation.hasError('trim')">Este campo es obligatorio.</mat-error>  
        </mat-form-field>
    </form>
  </ng-container>  
</ng-template>