<ng-container *ngIf="canRead">
  <div class="header__wrapper">
    <!-- <div>{{'secure.parametize.category.categories.exception'| translate}}</div> -->
    <div>{{'secure.parametize.category.categories.exception' | translate}}</div>
    <div *ngIf="canUpdate" fxShow="true" [fxShow.xs]="false">
      <button mat-stroked-button color="primary"
        (click)="openDialog('create')">{{'secure.parametize.commission.add' | translate}}</button>
    </div>
    <div fxShow="false" [fxShow.xs]="true" *ngIf="canUpdate">
      <button mat-stroked-button color="primary" (click)="openDialog('create')">{{'actions.add'| translate}}</button>
    </div>
  </div>

  <div class="table-wrapper">
    <div class="example-container">
      <table mat-table [dataSource]="dataSource">
        <ng-container matColumnDef="Brand">
          <th mat-header-cell *matHeaderCellDef> {{'shared.brand' | translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.Brand}} </td>
        </ng-container>

        <ng-container matColumnDef="Commission">
          <th mat-header-cell *matHeaderCellDef> {{'shared.commission' | translate}} </th>
          <td mat-cell *matCellDef="let element"> {{element.Commission}} </td>
        </ng-container>

        <ng-container matColumnDef="options">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let element">
            <div class="options">
              <button mat-icon-button [matTooltip]="'actions.edit' | translate" (click)="openDialog('edit', element)">
                <mat-icon>
                  edit
                </mat-icon>
              </button>
              <button mat-icon-button [matTooltip]="'actions.delete' | translate" (click)="deleteElement(element)">
                <mat-icon>
                  delete
                </mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns;"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </div>
  </div>

  <ng-template #dialogContent>

    <div class="full-width">
      <form [formGroup]="typeForm" class="full-width justify-content-center dis-flex">
        <mat-form-field class="half-width">
          <mat-label>Tipo de excepción</mat-label>
          <mat-select formControlName="type" [(ngModel)]="typeValue">
            <mat-option *ngFor="let type of typeException" value="{{type.value}}">
              {{type.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </form>

    </div>

    <form class="full-width space-between" [formGroup]="form" *ngIf="typeForm.get('type').value">
      <div fxLayout="column" fxLayoutAlign="space-around center" class="widthBrand">
        <div fxLayout="row" fxLayoutAlign="space-evenly center" class="widthBrand">
          <mat-form-field class="half-width">
            <input matInput [placeholder]="'shared.brand' | translate" [matAutocomplete]="auto" formControlName="Brand"
              id="brandProduct" required>
            <mat-autocomplete #auto="matAutocomplete">
              <mat-option *ngFor="let brand of filterBrands" [value]="brand.Name">
                {{brand.Name}}
              </mat-option>
            </mat-autocomplete>
            <mat-error *ngIf="form.get('Brand').hasError('required')">
              {{'secure.products.create_product_unit.basic_information.input_mandatory' | translate}}</mat-error>
            <mat-error *ngIf="form.get('Brand').hasError('pattern')">
              {{'secure.products.create_product_unit.basic_information.brand_invalidate' | translate}}</mat-error>
            <mat-error *ngIf="form.get('Brand').hasError('minLength')">
              {{'secure.products.create_product_unit.basic_information.brand_invalidate' | translate}}</mat-error>
          </mat-form-field>

          <mat-form-field class="half-width">
            <input matInput required id="exception" type="number" placeholder="Comisión" autocomplete="false"
              formControlName="Commission">
            <mat-error *ngIf="form.get('Commission').hasError('pattern') || form.get('Commission').hasError('trim')">
              {{'error.exception_brand.number_int' | translate}}</mat-error>
            <mat-error *ngIf="form.get('Commission').hasError('max')">{{'error.exception_brand.max_error' | translate}}
            </mat-error>
            <mat-error *ngIf="form.get('Commission').hasError('min')">{{'error.exception_brand.min_error' | translate}}
            </mat-error>
            <button mat-button mat-icon-button matSuffix *ngIf="!form.value.Id" [disabled]="!form.valid"
              (click)="addBrand()">
              <!-- <button mat-button mat-icon-button matSuffix 
                      (click)="addBrand()"> -->
              <mat-icon>
                add_circle_outline
              </mat-icon>
            </button>
          </mat-form-field>
        </div>

        <div class="dateException widthBrand" fxLayout="row" fxLayoutAlign="space-evenly center">
          <!-- Fecha Inicial -->
          <!-- <mat-form-field id="paymentDate-input-search-order" color="accent" fxFlex="20%">

            <input  [max]="form.value.DateInitial" formControlName="DateInitial"
              [placeholder]="'secure.parametize.support_claims-filter.start-date' | translate" matInput type="datetime-local"
              [matDatepicker]="DateInitial" class="datePicker">
            <mat-datepicker-toggle id="paymentDate-Perfix" matPrefix [for]="DateInitial">
            </mat-datepicker-toggle>
            <mat-datepicker touchUi="true" startView="year" #DateInitial></mat-datepicker>
          </mat-form-field> -->

          <!-- Hora inicial -->
          <!-- <mat-form-field fxFlex="20%"> -->
            <!-- <input matInput id="TimeInitial" type="datetime-local" placeholder="Hora inicio" autocomplete="false"
              formControlName="TimeInitial"> -->
          <!-- </mat-form-field> -->

          <mat-form-field>
            <input matInput type="datetime-local" placeholder="Hora inicio" autocomplete="false" 
            formControlName="InitialDate">
          </mat-form-field>

          <mat-form-field>
            <input matInput type="datetime-local" placeholder="Hora inicio" autocomplete="false" 
            formControlName="FinalDate">
          </mat-form-field>
          

          <!-- Fecha final
          <mat-form-field id="paymentDate-input-search-order" color="accent" fxFlex="20%">
            <input id="input-filter-paymentDateFinal" [min]="form.value.DateFinal" formControlName="DateFinal"
              [placeholder]="'secure.parametize.support_claims-filter.end-date' | translate" matInput
              [matDatepicker]="DateFinal">
            <mat-datepicker-toggle id="paymentDate-Perfix" matPrefix [for]="DateFinal"></mat-datepicker-toggle>
            <mat-datepicker touchUi="true" startView="year" #DateFinal></mat-datepicker>
          </mat-form-field>

           Hora final 
          <mat-form-field fxFlex="20%">
            <input matInput id="TimeFinal" type="number" placeholder="Hora fin" autocomplete="false"
              formControlName="TimeFinal">
          </mat-form-field> -->
        </div>

        <div *ngIf="actionsEdit" fxLayout="row" fxLayoutAlign="space-between center" class="buttonsSend">
          <button mat-flat-button color="default" type="button"
            (click)="close()">{{'actions.cancel' | translate}}</button>
          <button mat-flat-button color="primary" type="submit" [disabled]="!form.touched"
            (click)="confirmationEdit()">{{'actions.edit' | translate}}</button>
        </div>
      </div>

    </form>
    <ng-container *ngIf="selectedBrands.length > 0">
      <table mat-table [dataSource]="selectedBrandsSources">
        <ng-container matColumnDef="Brand">
          <th mat-header-cell *matHeaderCellDef> Marca </th>
          <td mat-cell *matCellDef="let element"> {{element.Brand}} </td>
        </ng-container>

        <ng-container matColumnDef="InitialDate">
          <th mat-header-cell *matHeaderCellDef> Fecha y hora inicial </th>
          <td mat-cell *matCellDef="let element"> {{element.InitialDate}} </td>
        </ng-container>

        <ng-container matColumnDef="FinalDate">
          <th mat-header-cell *matHeaderCellDef> Fecha y hora final </th>
          <td mat-cell *matCellDef="let element"> {{element.FinalDate}} </td>
        </ng-container>

        <ng-container matColumnDef="Commission">
          <th mat-header-cell *matHeaderCellDef> Comisión </th>
          <td mat-cell *matCellDef="let element"> {{element.Commission}} </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumnsInModal;"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsInModal;"></tr>
      </table>
    </ng-container>
  </ng-template>
</ng-container>
